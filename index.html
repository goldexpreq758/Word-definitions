<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Auto-detect Dictionary</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  input, button { font-size: 16px; margin: 5px 0; }
  #definition { margin-top: 10px; white-space: pre-wrap; }
</style>
</head>
<body>
<h2>Auto-detect Dictionary</h2>

<input type="text" id="wordInput" placeholder="Enter word">
<button onclick="getDefinition()">Get Definition</button>

<p id="definition"></p>

<script>
function detectLanguage(word) {
    const c = word[0];
    if (/[а-яёА-ЯЁ]/.test(c)) return 'ru';       // Cyrillic → Russian
    if (/[ぁ-んァ-ン一-龯]/.test(c)) return 'ja'; // Japanese
    if (/[a-zA-Z]/.test(c)) {
        // Simple heuristic for Latin script languages
        const turkishChars = /[çğıöşüÇĞİÖŞÜ]/;
        const frenchChars = /[éèêëàâôùûîïç]/;
        const spanishChars = /[áéíóúñü]/;
        if (turkishChars.test(word)) return 'tr';
        if (frenchChars.test(word)) return 'fr';
        if (spanishChars.test(word)) return 'es';
        return 'en'; // default Latin → English
    }
    return 'en'; // fallback
}

async function getDefinition() {
    const word = document.getElementById('wordInput').value.trim();
    const definitionElem = document.getElementById('definition');
    if (!word) {
        definitionElem.textContent = 'Please enter a word.';
        return;
    }
    
    const lang = detectLanguage(word);
    const apiUrl = `https://${lang}.wiktionary.org/w/api.php?action=query&titles=${word}&prop=extracts&format=json&origin=*`;
    
    try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        const pages = data.query.pages;
        const page = Object.values(pages)[0];
        if (page.extract) {
            const cleanText = page.extract.replace(/<[^>]*>?/gm, '');
            definitionElem.textContent = cleanText || 'Definition not found in detected language.';
        } else {
            definitionElem.textContent = 'Definition not found in detected language.';
        }
    } catch (error) {
        definitionElem.textContent = 'Error fetching definition.';
        console.error(error);
    }
}
</script>
</body>
</html>
